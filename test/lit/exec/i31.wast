;; NOTE: Assertions have been generated by update_lit_checks.py --output=fuzz-exec and should not be edited.

;; RUN: wasm-opt %s -all --fuzz-exec -q -o /dev/null 2>&1 | filecheck %s

(module
  (func $null (export "null") (result i32)
    (local $ref (ref null i31))
    (ref.is_null
      (local.get $ref)
    )
  )

  (func $nn-u (export "nn-u") (result i32)
    (local $ref (ref null i31))
    (local.set $ref
      (i31.new
        (i32.const 0xffffffff)
      )
    )
    (i31.get_u
      (local.get $ref)
    )
  )

  (func $nn-s (export "nn-s") (result i32)
    (local $ref (ref null i31))
    (local.set $ref
      (i31.new
        (i32.const 0xffffffff)
      )
    )
    (i31.get_s
      (local.get $ref)
    )
  )

  (func $zero-is-not-null (export "zero-is-not-null") (result i32)
    (local $ref (ref null i31))
    (local.set $ref
      (i31.new
        (i32.const 0)
      )
    )
    (i32.add ;; 0 + 0 is 0
      (ref.is_null
        (local.get $ref)
      )
      (i31.get_u ;; this should not trap on null
        (local.get $ref)
      )
    )
  )
)

