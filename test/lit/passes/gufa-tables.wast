;; NOTE: Assertions have been generated by update_lit_checks.py --all-items and should not be edited.
;; RUN: foreach %s %t wasm-opt -all --gufa -S -o - | filecheck %s

;; Non-private tables can contain anything, so we cannot assume anything about
;; the results of a call to them.
(module
 (type $type (func (result f64)))

 (import "a" "b" (table $imported 30 40 funcref))

 (table $exported 10 20 funcref)

 (table $private  50 60 funcref)

 (export "table" (table $table))

 (func $func (export "func")
  ;; We cannot optimize anything with the exported or imported table.
  (drop
   (call_indirect $exported (type $type)
    (i32.const 0)
   )
  )
  (drop
   (call_indirect $imported (type $type)
    (i32.const 0)
   )
  )
  ;; We can optimize the private table: this will trap.
  (drop
   (call_indirect $private (type $type)
    (i32.const 0)
   )
  )
 )
)

