;; NOTE: Assertions have been generated by update_lit_checks.py --all-items and should not be edited.
;; NOTE: This test was ported using port_test.py and could be cleaned up.

;; RUN: not wasm-opt %s --stack-check --enable-mutable-globals -S -o - 2>&1 | filecheck %s

;; if __stack_base and __stack_end are missing, the stack check pass should error
(module
 (import "env" "__stack_pointer" (global $sp (mut i32)))
 (export "use_stack" (func $0))
 (func $0 (result i32)
  (global.set $sp (i32.const 42))
  (global.get $sp)
 )
)
;; CHECK: Fatal: cannot do stack checking without __stack_base variable
