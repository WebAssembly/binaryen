;; NOTE: Assertions have been generated by update_lit_checks.py and should not be edited.

;; RUN: wasm-opt %s --remove-unused-names --precompute-propagate --fuzz-exec -all -S -o - \
;; RUN:   | filecheck %s

(module
 (type $struct (sub (struct (field i32))))

 (func $test
  (local $struct (ref null $struct))
  (local $int i32)
   (local.set $int
    (i32.const 0)
   )
   (loop $loop
    (local.set $struct
     (struct.new $struct
      (local.get $int)
     )
    )
    (local.set $int
     (i32.const 1)
    )
    (br_if $loop
     (i32.eqz
      (block $block1 (result i32)
       (block $block
        (drop
         (br_on_null $block
          (local.get $struct)
         )
        )
        (br $block1
         (struct.get $struct 0
          (local.get $struct)
         )
        )
       )
       (i32.const 0)
      )
     )
    )
   )
  )
 )
)
