;; NOTE: Assertions have been generated by update_lit_checks.py --all-items and should not be edited.

;; RUN: wasm-opt -all %s --closed-world --remove-unused-types -S -o - | filecheck %s

;; Check that exactness is preserved through type updating and that the
;; underlying heap types are actually updated.

(module
  (rec
    (type $unused (struct))
    ;; CHECK:      (type $used (struct (field (ref null $used)) (field (ref (exact $used)))))
    (type $used (struct (field (ref null $used) (ref (exact $used)))))
  )
  ;; CHECK:      (global $g (ref null (exact $used)) (ref.null none))
  (global $g (ref null (exact $used)) (ref.null none))
)
