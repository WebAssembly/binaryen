;; NOTE: Assertions have been generated by update_lit_checks.py and should not be edited.

;; RUN: wasm-opt -all --closed-world %s | filecheck %s

;; Test that we do not error on call.without.effects despite it being an import.
;; call.without.effects does not make the types in it public, and so it can
;; validate with --closed-world.

(module
  (type $struct (struct i32))

  (import "binaryen-intrinsics" "call.without.effects" (func $cwe (param (ref $struct)) (param funcref)))

  (func $test
    (call $cwe
      (struct.new $struct
        (i32.const 100)
      )
      (ref.func $func)
    )
  )

  (func $func (param $ref (ref $struct))
  )
)
