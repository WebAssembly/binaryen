;; NOTE: Assertions have been generated by update_lit_checks.py --all-items and should not be edited.

;; RUN: wasm-as %s -all -g -o %t.wasm
;; RUN: wasm-dis %t.wasm -all -o %t.wast
;; RUN: wasm-opt %t.wast -all -o %t.opt.wasm -g
;; RUN: cat %t.wast | filecheck %s
;; RUN: wasm-dis %t.opt.wasm -o - | filecheck %s --check-prefix=CHECK-OPT

(module
  ;; CHECK:      (type $none_=>_none (func))

  ;; CHECK:      (table $table-1 1 1 funcref)
  ;; CHECK-OPT:      (type $none_=>_none (func))

  ;; CHECK-OPT:      (table $table-1 1 1 funcref)
  (table $table-1 funcref
    (elem $foo)
  )

  ;; CHECK:      (table $table-2 3 3 funcref)
  ;; CHECK-OPT:      (table $table-2 3 3 funcref)
  (table $table-2 funcref
    (elem $bar $bar $bar)
  )

  ;; CHECK:      (elem $0 (table $table-1) (i32.const 0) func $foo)

  ;; CHECK:      (elem $1 (table $table-2) (i32.const 0) func $bar $bar $bar)

  ;; CHECK:      (func $foo
  ;; CHECK-NEXT:  (nop)
  ;; CHECK-NEXT: )
  ;; CHECK-OPT:      (elem $0 (table $table-1) (i32.const 0) func $foo)

  ;; CHECK-OPT:      (elem $1 (table $table-2) (i32.const 0) func $bar $bar $bar)

  ;; CHECK-OPT:      (func $foo
  ;; CHECK-OPT-NEXT:  (nop)
  ;; CHECK-OPT-NEXT: )
  (func $foo
    (nop)
  )
  ;; CHECK:      (func $bar
  ;; CHECK-NEXT:  (drop
  ;; CHECK-NEXT:   (table.get $table-1
  ;; CHECK-NEXT:    (i32.const 0)
  ;; CHECK-NEXT:   )
  ;; CHECK-NEXT:  )
  ;; CHECK-NEXT:  (drop
  ;; CHECK-NEXT:   (table.get $table-2
  ;; CHECK-NEXT:    (i32.const 100)
  ;; CHECK-NEXT:   )
  ;; CHECK-NEXT:  )
  ;; CHECK-NEXT: )
  ;; CHECK-OPT:      (func $bar
  ;; CHECK-OPT-NEXT:  (drop
  ;; CHECK-OPT-NEXT:   (table.get $table-1
  ;; CHECK-OPT-NEXT:    (i32.const 0)
  ;; CHECK-OPT-NEXT:   )
  ;; CHECK-OPT-NEXT:  )
  ;; CHECK-OPT-NEXT:  (drop
  ;; CHECK-OPT-NEXT:   (table.get $table-2
  ;; CHECK-OPT-NEXT:    (i32.const 100)
  ;; CHECK-OPT-NEXT:   )
  ;; CHECK-OPT-NEXT:  )
  ;; CHECK-OPT-NEXT: )
  (func $bar
    (drop
      (table.get $table-1
        (i32.const 0)
      )
    )
    (drop
      (table.get $table-2
        (i32.const 100)
      )
    )
  )
)
