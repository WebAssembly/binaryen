;; NOTE: Assertions have been generated by update_lit_checks.py --all-items and should not be edited.

;; RUN: wasm-split -all -g %s --keep-funcs=foo -o1 %t.1.wasm -o2 %t.2.wasm
;; RUN: wasm-dis %t.1.wasm | filecheck %s --check-prefix=PRIMARY
;; RUN: wasm-dis %t.2.wasm | filecheck %s --check-prefix=SECONDARY
(module
 ;; PRIMARY:      (type $0 (func (param i32) (result i32)))

 ;; PRIMARY:      (import "placeholder" "0" (func $placeholder_0 (param i32) (result i32)))

 ;; PRIMARY:      (table $table 1 1 funcref)
 (table $table 1 1 funcref)
 (elem (i32.const 0) $bar)
 (export "bar" (func $bar))
 ;; PRIMARY:      (table $1 1 funcref)

 ;; PRIMARY:      (elem $0 (table $table) (i32.const 0) func $trampoline_bar)

 ;; PRIMARY:      (elem $1 (table $1) (i32.const 0) func $placeholder_0)

 ;; PRIMARY:      (export "bar" (func $trampoline_bar))

 ;; PRIMARY:      (export "foo" (func $foo))

 ;; PRIMARY:      (export "table" (table $table))

 ;; PRIMARY:      (export "table_3" (table $1))

 ;; PRIMARY:      (func $foo (param $0 i32) (result i32)
 ;; PRIMARY-NEXT:  (call_indirect $1 (type $0)
 ;; PRIMARY-NEXT:   (i32.const 555)
 ;; PRIMARY-NEXT:   (i32.const 0)
 ;; PRIMARY-NEXT:  )
 ;; PRIMARY-NEXT: )
 (func $foo (param i32) (result i32)
  (call $bar (i32.const 555))
 )
 ;; SECONDARY:      (type $0 (func (param i32) (result i32)))

 ;; SECONDARY:      (import "primary" "table_3" (table $timport$0 1 funcref))

 ;; SECONDARY:      (import "primary" "foo" (func $foo (param i32) (result i32)))

 ;; SECONDARY:      (elem $0 (i32.const 0) $bar)

 ;; SECONDARY:      (func $bar (param $0 i32) (result i32)
 ;; SECONDARY-NEXT:  (call $foo
 ;; SECONDARY-NEXT:   (i32.const 777)
 ;; SECONDARY-NEXT:  )
 ;; SECONDARY-NEXT: )
 (func $bar (param i32) (result i32)
  (call $foo (i32.const 777))
 )
)
;; PRIMARY:      (func $trampoline_bar (param $0 i32) (result i32)
;; PRIMARY-NEXT:  (call_indirect $1 (type $0)
;; PRIMARY-NEXT:   (local.get $0)
;; PRIMARY-NEXT:   (i32.const 0)
;; PRIMARY-NEXT:  )
;; PRIMARY-NEXT: )
